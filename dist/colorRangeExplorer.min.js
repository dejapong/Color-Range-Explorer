!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var s=n;function n(){this.listeners={}}n.prototype.addEventListener=function(t,e){t in this.listeners||(this.listeners[t]=[]),-1==this.listeners[t].indexOf(e)&&this.listeners[t].push(e)},n.prototype.removeEventListener=function(t,e){if(t in this.listeners){let i=this.listeners[t].indexOf(e);i>-1&&this.listeners[t].splice(i,1)}return index},n.prototype.dispatchEvent=function(t){if(t.type in this.listeners){for(var e=this.listeners[t.type],i=0,s=e.length;i<s;i++)e[i].call(this,t);return!t.defaultPrevented}return!0};var a=h;function h(){s.call(this),this.x=0,this.y=0,this.height=40,this.width=0,this.min=0,this.max=1,this.hovering=!1}h.prototype=Object.create(s.prototype),h.prototype.handleMouseOver=function(t){return!this.hovering&&(this.hovering=!0,!0)},h.prototype.handleMouseOut=function(t){return!!this.hovering&&(this.hovering=!1,!0)},h.prototype.handleMouseDown=function(t){},h.prototype.handleMouseUp=function(t){},h.prototype.handleWheel=function(t){let e=t.deltaY,i=new Event("change");i.dX=0,i.dY=0,i.scaleBy=e/this.width,i.scaleRatio=t.offsetX/this.width,this.dispatchEvent(i)},h.prototype.handleMouseDrag=function(t){let e=new Event("change");e.dX=t.screenX-t.userMouse.startingPoint[0],e.dY=t.screenY-t.userMouse.startingPoint[1],e.scaleBy=0,this.dispatchEvent(e)};var o=r;function r(){a.call(this),this.x=0,this.y=0,this.height=20,this.width=0,this.hovering=!1}r.prototype=Object.create(a.prototype),r.prototype.resize=function(t,e){this.height=e,this.width=t},r.prototype.redraw=function(t,e,i){t.setTransform(1,0,0,1,0,0);e.max,e.min;let s=i.max-i.min,n=t.createImageData(this.width,this.height);for(let t=0;t<this.height;t++){let a=t*this.width*4;for(let t=0;t<this.width;t++){let h=t/this.width*s+i.min,o=e.evaluate(h),r=4*t;for(let t=0;t<o.length;t++)n.data[a+r+t]=o[t]}}t.putImageData(n,0,0),this.hovering&&(t.lineWidth=5,t.strokeRect(0,0,this.width,this.height))};var l=c;function c(t,e){a.call(this),this.numMajorTicks=5,this.numMinorDivs=10,this.dX=0,this.min=t,this.max=e}c.prototype=Object.create(a.prototype),c.prototype.resize=function(t,e){this.height=e,this.width=t},c.prototype.redraw=function(t){t.fillStyle="#ffffff",t.strokeStyle="#000000",t.lineWidth=this.hovering?2:1,t.font=this.hovering?"bold 10pt Courier":"10pt Courier",t.fillRect(this.x,this.y,this.width,this.height),t.beginPath(),t.moveTo(this.x,this.y),t.lineTo(this.x+this.width,this.y);let e=this.width/(this.numMajorTicks-1),i=e/this.numMinorDivs,s=this.y+(this.height-20),n=this.y+(this.height-20)/2,a=this.max-this.min,h=this.y+this.height-5;for(let o=0;o<this.numMajorTicks;o++){let r=this.dX%this.width+o*e;r<-e?r+=this.width+e:r>this.width+e&&(r-=this.width+e),t.moveTo(r,this.y),t.lineTo(r,s);for(let s=1;s<this.numMinorDivs;s++){let a=r+s*i;a<-e?a+=this.width+e:a>this.width+e&&(a-=this.width+e),t.moveTo(a,this.y),t.lineTo(a,n)}let l=(this.min+a*r/this.width+0).toFixed(2),c=t.measureText(l).width,u=r-c/2;u<0&&u>-c?u=r:u+c>this.width&&u<this.width&&(u=r-c),t.fillStyle="#000000",t.fillText(l,u,h)}t.stroke()},c.prototype.handleWheel=function(t){a.prototype.handleWheel.call(this,t)},c.prototype.handleMouseDown=function(t){t.userMouse.startingScaleControlDx=this.dX},c.prototype.handleMouseDrag=function(t){this.dX=t.userMouse.startingScaleControlDx+(t.screenX-t.userMouse.startingPoint[0]),a.prototype.handleMouseDrag.call(this,t)};var u=d;function d(t=0,e=1,i=10){this.min=t,this.max=e,this.scaleMin=0,this.scaleMax=1,this.scaleSize=1,this.rangeSize=1,this.scalingRatio=1,this.rangeSize=1,this.levels=i,this.setType("rainbow")}d.types={rainbow:function(t){let e=this._recodedNormalizedValue(t),i=3.5*e-1,s=e<.5?2*e:-2*e+2,n=-2*e+1;return this._clippedNormalizedUint8Array([i,s,n,1])},heat:function(t){let e=this._recodedNormalizedValue(t),i=3*e,s=3*e-1,n=3*e-2;return this._clippedNormalizedUint8Array([i,s,n,1])},twoColor:function(t){let e=this._recodedNormalizedValue(t),i=e>=.5?1*e:0,s=e<.5?1*e:0;return this._clippedNormalizedUint8Array([i,0,s,1])},terrain:function(t){let e=this._recodedNormalizedValue(t),i=[0,0,0,1];return e<.25?(i[1]=3*e,i[2]=4*e+.25):e<.3?(i[0]=.9*e*3.3,i[1]=.9*e*3.3,i[2]=.7*e*3.3):e<.8?(i[0]=.2*(.5-e),i[1]=.8*(.8-e),i[2]=.3*(.5-e)):(i[0]=(e-.8)/.2,i[1]=(e-.8)/.2,i[2]=(e-.8)/.2),this._clippedNormalizedUint8Array(i)}},d.prototype._recodedNormalizedValue=function(t){let e=1/this.levels,i=(Math.max(Math.min(t,this.max),this.min)-this.min)/(this.max-this.min);return Math.floor(i/e)*e},d.prototype._clippedNormalizedUint8Array=function(t){let e=[];for(let i=0;i<t.length;i++)e[i]=Math.round(255*Math.min(1,Math.max(0,t[i])));return e},d.prototype.setType=function(t){this.evaluate=d.types[t]};var p=m;function m(t,e=400,i=70){s.call(this),t=Object.assign({scaleMin:0,scaleMax:1,mapMin:0,mapMax:1,numLevels:5},t),this.container=document.createElement("div"),this.canvas=document.createElement("canvas"),this.controls=document.createElement("div"),this.canvas.className="colorRangeControls",this.container.appendChild(this.canvas),this.container.appendChild(this.controls),Object.assign(this.canvas.style,{width:"100%",height:`${i}px`,background:"#000"}),this.ctx=this.canvas.getContext("2d"),this.width=e,this.height=i,this.colorBar=new o,this.scale=new l(t.scaleMin,t.scaleMax),this.map=new u(t.mapMin,t.mapMax,t.numLevels),this.userMouse={down:!1},window.addEventListener("mousemove",this._onMouseMove.bind(this)),window.addEventListener("mousedown",this._onMouseDown.bind(this)),window.addEventListener("mouseup",this._onMouseUp.bind(this)),window.addEventListener("wheel",this._onWheel.bind(this)),this.colorBar.addEventListener("change",this._onColorControlChange.bind(this)),this.scale.addEventListener("change",this._onScaleControlChange.bind(this)),this.resize(this.width,this.height)}m.prototype=Object.create(s.prototype),m.prototype._onColorControlChange=function(t){if(t.dX){let e=(this.scale.max-this.scale.min)*t.dX/this.width;this.map.min=this.userMouse.startingMapValues[0]+e,this.map.max=this.userMouse.startingMapValues[1]+e}if(t.scaleBy){let e=t.scaleBy*(this.map.max-this.map.min),i=(this.scale.min,this.map.max,this.map.min,this.scale.max,this.map.max,this.map.min,(t.scaleRatio*(this.scale.max-this.scale.min)+this.scale.min-this.map.min)/(this.map.max-this.map.min));this.map.min-=e*i,this.map.max+=e*(1-i)}this.dispatchEvent(t),requestAnimationFrame(this.redraw.bind(this))},m.prototype._onScaleControlChange=function(t){if(t.dX){let e=(this.scale.max-this.scale.min)*t.dX/this.width;this.scale.min=this.userMouse.startingScaleControlValues[0]-e,this.scale.max=this.userMouse.startingScaleControlValues[1]-e,this.map.min=this.userMouse.startingMapValues[0]-e,this.map.max=this.userMouse.startingMapValues[1]-e}if(t.scaleBy){let e=t.scaleBy*(this.scale.max-this.scale.min),i=(this.scale.min,this.scale.max,this.scale.min,this.scale.max,this.scale.max,this.scale.min,(t.scaleRatio*(this.scale.max-this.scale.min)+this.scale.min-this.scale.min)/(this.scale.max-this.scale.min));this.setScaleMin(this.scale.min-e*i),this.setScaleMax(this.scale.max+e*(1-i))}this.dispatchEvent(t),requestAnimationFrame(this.redraw.bind(this))},m.prototype._adjustScaleControl=function(t,e){let i=(e*(this.scale.max-this.scale.min)+this.scale.min-this.map.min)/(this.map.max-this.map.min),s=t*(this.map.max-this.map.min)/(this.scale.max-this.scale.min);this.map.min-=s*i,this.map.max+=s*(1-i)},m.prototype._initUserMouse=function(t){t.offsetY>this.height-this.scale.height?this.userMouse.down=this.scale:this.userMouse.down=this.colorBar,this.userMouse.startingMapValues=[this.map.min,this.map.max],this.userMouse.startingScaleControlValues=[this.scale.min,this.scale.max],this.userMouse.startingPoint=[t.screenX,t.screenY],t.userMouse=this.userMouse},m.prototype._onMouseDown=function(t){t.target==this.canvas&&(this._initUserMouse(t),this.userMouse.down.handleMouseDown(t))},m.prototype._onWheel=function(t){t.target==this.canvas&&(this._initUserMouse(t),this.userMouse.down.handleWheel(t),t.preventDefault(),this.userMouse.down=null)},m.prototype._onMouseMove=function(t){this.userMouse.down&&(t.userMouse=this.userMouse,this.userMouse.down.handleMouseDrag(t));let e=!1;(e=t.target==this.canvas?t.offsetY>this.height-this.scale.height?this.scale.handleMouseOver(t)||this.colorBar.handleMouseOut(t):this.colorBar.handleMouseOver(t)||this.scale.handleMouseOut(t):this.colorBar.handleMouseOut(t)||this.scale.handleMouseOut(t))&&requestAnimationFrame(this.redraw.bind(this))},m.prototype._onMouseUp=function(t){this.userMouse.down&&(t.userMouse=this.userMouse,this.userMouse.down.handleMouseUp(t),this.userMouse.down=null)},m.prototype.redraw=function(){this.colorBar.redraw(this.ctx,this.map,this.scale),this.scale.redraw(this.ctx)},m.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e,this.colorBar.resize(t,e-this.scale.height),this.scale.resize(t,this.scale.height),this.scale.y=e-this.scale.height,Object.assign(this.canvas.style,{width:t,height:e}),requestAnimationFrame(this.redraw.bind(this)),this.dispatchEvent(new Event("change"))},m.prototype.evaluate=function(t){return this.map.evaluate(Math.max(this.scale.min,Math.min(this.scale.max,t)))},m.prototype.setScaleMin=function(t){let e=parseFloat(t);if(e<this.scale.max){let t=this.scale.max-e,i=this.scale.max-this.scale.min;this._adjustScaleControl(t-i,1),this.scale.min=e}this.dispatchEvent(new Event("change")),requestAnimationFrame(this.redraw.bind(this))},m.prototype.setScaleMax=function(t){let e=parseFloat(t);if(e>this.scale.min){let t=e-this.scale.min,i=this.scale.max-this.scale.min;this._adjustScaleControl(t-i,0),this.scale.max=e}this.dispatchEvent(new Event("change")),requestAnimationFrame(this.redraw.bind(this))},m.prototype.setLevels=function(t){this.map.levels=parseFloat(t),this.dispatchEvent(new Event("change")),requestAnimationFrame(this.redraw.bind(this))},m.prototype.reset=function(){this.map.min=0,this.map.max=1,this.scale.min=0,this.scale.max=1,this.scale.dX=0,this.dispatchEvent(new Event("change")),requestAnimationFrame(this.redraw.bind(this))};var v=f;function f(t){s.call(this),this.container=document.createElement("div"),this.tooltip=document.createElement("div"),Object.assign(this.tooltip.style,{display:"none",position:"absolute"}),this.canvas=document.createElement("canvas"),this.container.appendChild(this.canvas),this.container.appendChild(this.tooltip),this.ctx=this.canvas.getContext("2d"),this.selector=t,this.canvas.addEventListener("mousemove",this._onMouseMove.bind(this)),this.canvas.addEventListener("mouseout",this._onMouseOut.bind(this)),this.tooltip.className="colorRangeTooltip"}f.prototype=Object.create(s.prototype),f.prototype._onMouseOut=function(t){Object.assign(this.tooltip.style,{display:"none"})},f.prototype._onMouseMove=function(t){let e=4*(t.offsetY*this.canvas.width+t.offsetX);Object.assign(this.tooltip.style,{display:"block",left:t.pageX,top:t.pageY+20}),this.tooltip.innerHTML=this._valueFromPixel(this.rawImageData.data,e).toFixed(2)},f.prototype._valueFromPixel=function(t,e){return(t[e+0]+t[e+1]+t[e+2])/3/255},f.prototype.loadImage=function(t){let e=new Image;e.onload=(()=>{this.canvas.width=e.width,this.canvas.height=e.height,this.ctx.drawImage(e,0,0),this.rawImageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);let t=new Event("resize");t.width=e.width,t.height=e.height,this.dispatchEvent(t),requestAnimationFrame(this.redraw.bind(this))}),e.src=t},f.prototype.redraw=function(){if(this.rawImageData&&this.selector){let t=this.ctx.createImageData(this.canvas.width,this.canvas.height),e=this.rawImageData;for(let i=0;i<e.data.length;i+=4){let s=this._valueFromPixel(e.data,i),n=this.selector.evaluate(s),a=n[0],h=n[1],o=n[2],r=e.data[i+3];t.data[i+0]=a,t.data[i+1]=h,t.data[i+2]=o,t.data[i+3]=r}this.ctx.putImageData(t,0,0)}},window.ColorRangeExplorer=function(t,e={}){e=Object.assign({inputSelection:null,currentInput:null,mapSelection:null,currentMap:"rainbow",levelSelection:!1,numLevels:5,scaleMin:0,scaleMax:1,mapMin:0,mapMax:1},e);let i=document.getElementById(t),s=new p(e),n=new v(s),a=document.createElement("div"),h=document.createElement("input"),o=document.createElement("input"),r=document.createElement("input");r.type="button",r.value="Fit Data",h.className="colorRangeMinInput",o.className="colorRangeMaxInput",h.size=5,o.size=5,h.tabIndex=1,o.tabIndex=2,r.tabIndex=3,a.appendChild(h),a.appendChild(r),a.appendChild(o);let l=document.createElement("div"),c=document.createElement("label"),u=document.createElement("select"),d=document.createElement("label"),m=document.createElement("select"),f=document.createElement("label"),g=document.createElement("input");if(l.className="colorRangeControls",c.innerHTML="Input",d.innerHTML="Map",f.innerHTML="Levels",g.size=5,e.inputSelection){for(let t of e.inputSelection){let e=document.createElement("option");e.value=t,e.innerHTML=t,u.appendChild(e)}l.appendChild(c),l.appendChild(u)}if(e.mapSelection){for(let t of e.mapSelection){let e=document.createElement("option");e.value=t,e.innerHTML=t,m.appendChild(e)}l.appendChild(d),l.appendChild(m)}e.levelSelection&&(l.appendChild(f),l.appendChild(g)),i.appendChild(l),i.appendChild(n.container),i.appendChild(a),i.appendChild(s.container),n.addEventListener("resize",function(t){Object.assign(i.style,{width:`${t.width}px`}),s.resize(t.width,s.height)}),s.addEventListener("change",t=>{n.redraw(),h.value=s.scale.min.toFixed(2),o.value=s.scale.max.toFixed(2),g.value=s.map.levels}),h.addEventListener("change",function(t){s.setScaleMin(t.target.value)}),o.addEventListener("change",function(t){s.setScaleMax(t.target.value)}),g.addEventListener("change",function(t){s.setLevels(t.target.value)}),r.addEventListener("click",function(t){s.reset()}),u.addEventListener("change",function(t){n.loadImage(this.value)}),m.addEventListener("change",function(t){s.map.setType(this.value),s.redraw(),n.redraw()}),e.currentInput&&n.loadImage(e.currentInput),e.currentMap&&s.map.setType(e.currentMap)},window.ColorRangeExplorer.COLOR_MAP_TYPES=Object.keys(u.types)}]);